networks:
  devnet:
    driver: bridge

volumes:
  reth-data:

services:
  init:
    image: alpine:3.20
    container_name: init-genesis
    command: ["/bin/sh", "/shared/init.sh"]
    #entrypoint: ["sleep", "infinity"]
    volumes:
      - reth-data:/data
      - ./shared:/shared
    networks: [devnet]
  reth:
    image: scalarorg/fastevm-execution:latest
    container_name: reth-node
    restart: unless-stopped
    user: root
    ports:
      - "8545:8545"   # HTTP RPC
      - "8546:8546"   # WS RPC
      - "8551:8551"   # Engine API (for CL)
    volumes:
      - reth-data:/data:rw
    command:
      [
        "node",
        "--chain", "dev", # possible values: mainnet,sepolia,holesky,hoodi,dev
        "--datadir", "/data",
        "--http",
        "--http.api", "eth,net,web3",
        "--http.addr", "0.0.0.0",
        "--http.port", "8545",
        "--ws",
        "--ws.api", "eth,net,web3",
        "--ws.addr", "0.0.0.0",
        "--ws.port", "8546",
        "--authrpc.addr", "0.0.0.0",
        "--authrpc.port", "8551",
        "--authrpc.jwtsecret", "/data/jwt.hex"
      ]
